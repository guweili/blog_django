{% extends 'base.html' %}

{% block title %}
    {{ blog.title }}
{% endblock %}

{% block nav_blog_active %}
    active
{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-xs-10 col-xg-offset-1">
                <h3>{{ blog.title }}</h3>
                <span style="margin-right: 2em;">作者：{{ blog.author }}</span>
                <span style="margin-right: 2em;">发表日期：{{ blog.created_time }}</span>
                <span style="margin-right: 2em;">阅读人数：{{ blog.read_count }}</span>
                <span style="margin-right: 2em;">文章分类：
                    <a href="{% url 'blogs_with_type' blog.blog_type.id %}">
                        {{ blog.blog_type }}
                    </a>
                </span>
                <br>
                <div style="display: inline-block; margin-right: 2em; text-indent: 2em;">{{ blog.content }}</div>

                <div style="margin-top: 1em;">上一篇:
                    {% if next_blog %}
                        <a href="{% url 'blog_detail' next_blog.id %}"> {{ next_blog.title }}</a>
                    {% else %}
                        暂无博客
                    {% endif %}
                </div>
                <div style="margin-top: 1em;">下一篇:
                    {% if previous_blog %}
                        <a href="{% url 'blog_detail' previous_blog.id %}"> {{ previous_blog.title }}</a>
                    {% else %}
                        暂无博客
                    {% endif %}
                </div>

                <div class="row">
                    <div class="col-xs-10 col-xs-offset-1">
                        <div class="comment-area">
                            <h3 class="comment-area-title">
                                提交评论
                            </h3>
                            {% if user.is_authenticated %}
                                <form action="{% url 'comment' %}" method="post" style="overflow: hidden;">
                                    {% csrf_token %}
                                    <div class="form-group">
                                        <lable for="comment_text">{{ user }} : 已登陆</lable>
                                        <textarea id="comment_text" class="form-control" name="text" cols="30"
                                                  rows="10">
                                        </textarea>
                                    </div>

                                    <input type="hidden" name="obj_id" value="{{ blog.id }}">
                                    <input type="hidden" name="content_type" value="blog">
                                    <input class="btn btn-primary" type="submit" value="提交评论" style="float: right">
                                </form>
                            {% else %}
                                你尚未登陆，请登陆后平论 ~
                                <a class="btn btn-primary"
                                   href="{% url 'login' %}?from={{ request.get_full_path }}">登陆</a>
                                <span> or </span>
                                <a class="btn btn-danger" href="{% url 'register' %}?from={{ request.get_full_path }}">注册</a>
                            {% endif %}
                        </div>
                        <div class="comment-area">
                            <h3 class="comment-area-title">
                                评论列表
                            </h3>
                            {% for comment in comments %}
                                <div>
                                    {{ comment.user.username }}
                                    ({{ comment.created_time }})
                                    {{ comment.text }}
                                </div>
                            {% empty %}
                                暂无评论
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block css %}
    <style>
        .comment-area {
            margin-top: 2em;
        }

        .comment-area-title {
            border-bottom: 1px solid #ccc;
            padding-bottom: 0.4em;
        }

    </style>
{% endblock %}